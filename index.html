<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pulido Asesores | Tr√≠ptico para Impresi√≥n</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<style>
:root {
  --primary-blue: #0b1e33;
  --accent-blue: #2a7de1;
  --dark-bg: #05070d;
  --light-bg: #ffffff;
  --text-dark: #333333;
  --text-light: #666666;
  --border-color: #e0e0e0;
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Segoe UI', system-ui, -apple-system, sans-serif; background: #f5f5f5; padding: 20px; }
.container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); overflow: hidden; }

/* Controles */
.controls-header { background: var(--primary-blue); color: white; padding: 20px; text-align: center; }
.controls-header h1 { font-size: 24px; margin-bottom: 10px; }
.controls { display: flex; justify-content: center; gap: 15px; margin-top: 20px; flex-wrap: wrap; }
.btn { padding: 12px 24px; background: var(--accent-blue); color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 600; transition: all 0.3s ease; display: flex; align-items: center; gap: 8px; }
.btn:hover { background: #1a6bc7; transform: translateY(-2px); }
.btn-print { background: #28a745; }
.btn-print:hover { background: #218838; }
.btn-download { background: var(--accent-blue); }
.btn-help { background: #6c757d; }
.btn-help:hover { background: #5a6268; }

/* Vista previa del tr√≠ptico */
.triptych-preview { padding: 30px; display: flex; flex-direction: column; align-items: center; gap: 30px; }
.preview-container { display: flex; gap: 20px; flex-wrap: wrap; justify-content: center; }

/* --- ESTILOS PRINCIPALES DEL TR√çPTICO - AJUSTADOS PARA IMPRESI√ìN --- */
.triptych { display: flex; background: white; box-shadow: 0 5px 15px rgba(0,0,0,0.15); position: relative; }

/* Cada panel del tr√≠ptico CON REBASE Y DIMENSIONES AJUSTADAS */
.panel {
  width: 99mm; /* Ancho est√°ndar para tr√≠ptico A4 */
  height: 210mm; /* Alto A4 */
  /* REBASE/bleed: 12mm = 1.2cm + m√°rgenes internos reducidos para evitar desbordamiento */
  padding: 18mm 10mm 12mm 10mm; /* REDUCIDO: Top: 18mm (12mm rebase + 6mm contenido) */
  position: relative;
  page-break-inside: avoid;
  overflow: hidden; /* Evita que contenido se salga */
  box-sizing: border-box;
}

/* LADO A - Exterior del tr√≠ptico */
.panel-a { background: linear-gradient(135deg, var(--primary-blue) 0%, #1a3a5f 100%); color: white; border-right: 1px dashed rgba(255,255,255,0.2); }
.panel-b { background: linear-gradient(135deg, #1a3a5f 0%, var(--primary-blue) 100%); color: white; border-right: 1px dashed rgba(255,255,255,0.2); }
.panel-c { background: linear-gradient(135deg, var(--primary-blue) 0%, #0b1e33 100%); color: white; }

/* LADO B - Interior del tr√≠ptico */
.panel-d, .panel-e, .panel-f { background: white; color: var(--text-dark); border-right: 1px dashed var(--border-color); }
.panel-f { border-right: none; }

/* Estilos de contenido del tr√≠ptico - AJUSTADOS */
.triptych-content {
  height: 100%;
  display: flex;
  flex-direction: column;
  position: relative;
  z-index: 2;
  overflow: hidden; /* Previene desbordamiento */
}

/* TIPOGRAF√çA AJUSTADA PARA CABER EN HOJA */
.triptych-title {
  font-size: 22px !important; /* REDUCIDO de 28px */
  font-weight: 800;
  margin-bottom: 4mm !important; /* REDUCIDO */
  text-transform: uppercase;
  letter-spacing: 0.5px;
  line-height: 1.2;
}

.triptych-subtitle {
  font-size: 16px !important; /* REDUCIDO de 18px */
  font-weight: 600;
  margin-bottom: 6mm !important; /* REDUCIDO */
  color: var(--accent-blue);
  line-height: 1.4;
}

.triptych-text {
  font-size: 12px !important; /* REDUCIDO de 14px */
  line-height: 1.5 !important; /* REDUCIDO de 1.6 */
  margin-bottom: 6mm !important; /* REDUCIDO */
}

.triptych-list {
  list-style: none;
  margin: 3mm 0 !important; /* REDUCIDO */
  padding: 0;
}

.triptych-list li {
  padding: 2mm 0 2mm 4mm !important; /* REDUCIDO */
  position: relative;
  font-size: 11px !important; /* REDUCIDO de 13px */
  line-height: 1.4 !important; /* REDUCIDO */
  border-bottom: 1px solid rgba(255,255,255,0.1);
  page-break-inside: avoid;
}

.panel-d .triptych-list li,
.panel-e .triptych-list li,
.panel-f .triptych-list li {
  border-bottom: 1px solid rgba(0,0,0,0.1);
}

.triptych-list li:before {
  content: "‚Ä¢";
  color: var(--accent-blue);
  position: absolute;
  left: 0;
  font-size: 14px;
}

.highlight-box {
  background: rgba(42, 125, 225, 0.1);
  border-left: 3px solid var(--accent-blue); /* REDUCIDO */
  padding: 4mm !important; /* REDUCIDO de 6mm */
  margin: 5mm 0 !important; /* REDUCIDO de 8mm */
  border-radius: 2px;
}

.highlight-title {
  font-size: 14px !important; /* REDUCIDO de 16px */
  font-weight: 700;
  margin-bottom: 2mm !important; /* REDUCIDO */
  color: var(--accent-blue);
}

.contact-info {
  margin-top: auto;
  padding-top: 5mm !important; /* REDUCIDO de 8mm */
  border-top: 1px solid rgba(255,255,255,0.1);
  font-size: 10px !important; /* REDUCIDO de 12px */
  text-align: center;
}

.panel-d .contact-info,
.panel-e .contact-info,
.panel-f .contact-info {
  border-top: 1px solid var(--border-color);
}

.logo-container {
  margin-bottom: 8mm !important; /* REDUCIDO de 10mm */
  text-align: center;
}

.triptych-logo {
  max-width: 50mm !important; /* REDUCIDO de 60mm */
  height: auto;
  margin: 0 auto 4mm !important; /* REDUCIDO */
}

.qr-container {
  text-align: center;
  margin: 5mm 0 !important; /* REDUCIDO de 8mm */
}

.qr-placeholder {
  width: 22mm !important; /* REDUCIDO de 25mm */
  height: 22mm !important; /* REDUCIDO de 25mm */
  background: #f8f9fa;
  border: 1px solid var(--border-color);
  margin: 0 auto 2mm !important; /* REDUCIDO */
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-light);
  font-size: 9px !important; /* REDUCIDO */
}

/* ESTILOS PARA IM√ÅGENES INTEGRADAS - AJUSTADAS */
.content-image {
  width: 100%;
  max-height: 35mm !important; /* REDUCIDO de 45mm */
  object-fit: cover;
  border-radius: 3px;
  margin: 3mm 0 4mm 0 !important; /* REDUCIDO */
  border: 1px solid rgba(0,0,0,0.05);
  display: block;
  page-break-inside: avoid;
}

.bg-image {
  position: absolute;
  top: 12mm;
  left: 12mm;
  width: calc(100% - 24mm);
  height: calc(100% - 24mm);
  object-fit: cover;
  opacity: 0.07;
  z-index: 1;
  pointer-events: none;
}

.full-panel-image {
  position: absolute;
  top: 12mm;
  left: 12mm;
  width: calc(100% - 24mm);
  height: calc(100% - 24mm);
  object-fit: cover;
  z-index: 1;
  border-radius: 2px;
  opacity: 0.9; /* A√±adido para mejor legibilidad del texto superpuesto */
}

.image-overlay-content {
  position: relative;
  z-index: 2;
  background: rgba(11, 30, 51, 0.82); /* Aumentada opacidad para mejor legibilidad */
  padding: 4mm !important; /* REDUCIDO */
  border-radius: 3px;
  color: white;
}

/* CONTENEDORES DE COLUMNAS AJUSTADOS */
.column-container {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2mm !important; /* REDUCIDO de 3mm */
  font-size: 10px !important; /* REDUCIDO de 12px */
  margin: 4mm 0 !important; /* REDUCIDO */
}

.column-section {
  background: #f8f9fa;
  padding: 3mm !important; /* REDUCIDO */
  border-radius: 3px;
}

/* Instrucciones de impresi√≥n */
.print-instructions { background: #f8f9fa; border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; margin-top: 20px; max-width: 800px; }
.print-instructions h3 { color: var(--primary-blue); margin-bottom: 15px; font-size: 18px; }
.print-steps { display: flex; flex-wrap: wrap; gap: 15px; margin-top: 15px; }
.step { flex: 1; min-width: 200px; background: white; padding: 15px; border-radius: 6px; border-left: 4px solid var(--accent-blue); }
.step-number { display: inline-block; width: 25px; height: 25px; background: var(--accent-blue); color: white; border-radius: 50%; text-align: center; line-height: 25px; font-weight: bold; margin-right: 10px; }

/* --- ESTILOS ESPEC√çFICOS PARA IMPRESI√ìN CON REBASE Y AJUSTES --- */
@media print {
  body {
    background: white;
    padding: 0;
    margin: 0;
    width: 100%;
    height: 100%;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }
  
  .controls-header,
  .preview-container,
  .print-instructions {
    display: none !important;
  }
  
  .triptych-preview {
    padding: 0;
    margin: 0;
  }
  
  .triptych {
    box-shadow: none;
    margin: 0;
    padding: 0;
  }
  
  /* Forzar saltos de p√°gina entre lados del tr√≠ptico */
  .side-a {
    page-break-after: always;
  }
  
  /* Configuraci√≥n de rebase (sangrado) para la impresora */
  @page {
    size: A4 portrait;
    margin: 12mm; /* Este es el margen de REBASE solicitado (1.2cm) */
    marks: crop cross; /* A√±ade marcas de corte para la imprenta */
    padding: 0;
  }
  
  /* Asegurar que el contenido se mantenga dentro de los m√°rgenes seguros */
  .panel {
    width: 99mm !important;
    height: 210mm !important;
    padding: 18mm 10mm 12mm 10mm !important;
    margin: 0 !important;
    overflow: hidden !important;
  }
  
  /* Asegurar que todo el contenido quepa */
  .triptych-content {
    height: 186mm !important; /* 210mm - 12mm(top) - 12mm(bottom) */
    overflow: hidden !important;
  }
  
  /* Marca de agua para impresi√≥n */
  .panel-a::before,
  .panel-b::before,
  .panel-c::before,
  .panel-d::before,
  .panel-e::before,
  .panel-f::before {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) rotate(-45deg);
    width: 180px !important; /* REDUCIDO */
    height: 90px !important; /* REDUCIDO */
    background-image: url('https://i.imgur.com/DGBtqM1.png');
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    opacity: 0.03;
    z-index: 1;
    pointer-events: none;
  }
  
  /* Ajustes adicionales para evitar desbordamiento */
  * {
    max-height: 100% !important;
    overflow: hidden !important;
  }
}

/* Responsive */
@media (max-width: 1100px) { .preview-container { transform: scale(0.9); } }
@media (max-width: 900px) {
  .preview-container { transform: scale(0.8); }
  .controls { flex-direction: column; align-items: center; }
  .btn { width: 100%; max-width: 300px; justify-content: center; }
}
@media (max-width: 768px) {
  .preview-container { transform: scale(0.7); }
  .step { min-width: 100%; }
}

/* Modal de ayuda */
.modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.8);
  z-index: 1000;
  align-items: center;
  justify-content: center;
}
.modal-content {
  background: white;
  border-radius: 8px;
  max-width: 500px;
  width: 90%;
  padding: 30px;
  position: relative;
}
.modal-close {
  position: absolute;
  top: 15px;
  right: 15px;
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: #666;
}
.modal h2 { color: var(--primary-blue); margin-bottom: 15px; }
.modal p { margin-bottom: 15px; line-height: 1.6; }
</style>
</head>
<body>

<div class="container">
  <div class="controls-header">
    <h1>Tr√≠ptico Pulido Asesores</h1>
    <p>Dise√±o optimizado para impresi√≥n - Todos los elementos ajustados a la hoja</p>
    <div class="controls">
      <button class="btn btn-print" onclick="window.print()"><i class="fas fa-print"></i> Imprimir Tr√≠ptico</button>
      <button class="btn btn-download" id="downloadTriptico"><i class="fas fa-download"></i> Descargar PDF</button>
      <button class="btn btn-help" id="openHelp"><i class="fas fa-question-circle"></i> Instrucciones</button>
    </div>
  </div>

  <div class="triptych-preview">
    <h2 style="color: var(--primary-blue); text-align: center;">Vista Previa - Dise√±o Ajustado a Hoja A4</h2>
    <p style="text-align: center; color: #28a745; max-width: 800px; margin: 0 auto 20px; font-weight: 600;">
      <i class="fas fa-check-circle"></i> Todos los elementos han sido ajustados para caber correctamente en la hoja de impresi√≥n
    </p>
    
    <div class="preview-container">
      <!-- LADO A - Exterior (Se ve cuando est√° doblado) -->
      <div style="text-align: center; margin-bottom: 10px; width: 100%;">
        <h3 style="color: var(--primary-blue);">LADO A - Exterior (Cara visible)</h3>
      </div>
      
      <div class="triptych side-a">
        <!-- Panel 1 (Cubierta izquierda) CON IMAGEN DE FONDO -->
        <div class="panel panel-a">
          <img src="https://i.imgur.com/lypuRIZ.png" class="bg-image" alt="Fondo profesional">
          <div class="triptych-content">
            <div class="logo-container">
              <img src="https://i.imgur.com/DGBtqM1.png" class="triptych-logo" alt="Pulido Asesores">
            </div>
            <h2 class="triptych-title">Especialistas en Auditor√≠a</h2>
            <div class="highlight-box">
              <h3 class="highlight-title">Nuestro Enfoque</h3>
              <p class="triptych-text">Auditor√≠a como acompa√±amiento estrat√©gico, con rigor t√©cnico y proximidad al cliente.</p>
            </div>
            <img src="https://i.imgur.com/c1al2rA.png" class="content-image" alt="Equipo de trabajo profesional">
            <ul class="triptych-list">
              <li>Auditor√≠a Financiera</li>
              <li>Auditor√≠a Fiscal</li>
              <li>Control Interno</li>
              <li>BPS & BPO</li>
            </ul>
            <div class="contact-info">
              <p><strong>Tel:</strong> +52-56-6855-0117</p>
              <p><strong>Email:</strong> contacto@pulidoasesores.com</p>
            </div>
          </div>
        </div>
        
        <!-- Panel 2 (Cubierta central) CON IMAGEN DE FONDO COMPLETA -->
        <div class="panel panel-b">
          <img src="https://i.imgur.com/Azdj5Zf.png" class="full-panel-image" alt="Concepto de auditor√≠a y confianza">
          <div class="image-overlay-content" style="text-align: center; height: 100%; display: flex; flex-direction: column; justify-content: center;">
            <div style="margin-bottom: 12mm;">
              <h1 style="font-size: 32px; font-weight: 900; margin-bottom: 4mm; color: white;">PULIDO ASESORES</h1>
              <h2 style="font-size: 18px; font-weight: 300; color: #e0e0e0;">Firma Especializada</h2>
            </div>
            <div style="margin: 8mm 0;">
              <p style="font-size: 14px; line-height: 1.6; margin-bottom: 6mm;">Certeza financiera ‚Ä¢ Control ‚Ä¢ Confianza</p>
              <div style="border-top: 2px solid rgba(255,255,255,0.3); border-bottom: 2px solid rgba(255,255,255,0.3); padding: 6mm 0; margin: 8mm 0;">
                <p style="font-size: 16px; font-weight: 600;">"Transformamos el control en una herramienta de crecimiento"</p>
              </div>
            </div>
            <div class="qr-container">
              <div class="qr-placeholder">QR Code<br>Scan aqu√≠</div>
              <p style="font-size: 10px; color: white;">Escanea para m√°s informaci√≥n</p>
            </div>
          </div>
        </div>
        
        <!-- Panel 3 (Cubierta derecha) CON IMAGEN INTEGRADA -->
        <div class="panel panel-c">
          <div class="triptych-content">
            <h2 class="triptych-title">¬øPor qu√© elegirnos?</h2>
            <div style="margin: 6mm 0;">
              <h3 style="font-size: 14px; margin-bottom: 3mm; color: var(--accent-blue);">Ventajas Competitivas</h3>
              <ul class="triptych-list">
                <li><strong>Enfoque preventivo:</strong> Identificamos riesgos oportunamente</li>
                <li><strong>Acompa√±amiento cercano:</strong> M√°s que auditores, somos aliados</li>
                <li><strong>Rigor t√©cnico:</strong> Metodolog√≠as actualizadas y robustas</li>
                <li><strong>Soluciones integrales:</strong> Auditor√≠a + BPS + BPO integrados</li>
              </ul>
            </div>
            <img src="https://i.imgur.com/yWbW5EY.png" class="content-image" alt="Servicios de auditor√≠a">
            <div class="highlight-box">
              <h3 class="highlight-title">CP Gilberto Pulido</h3>
              <p style="font-size: 12px; line-height: 1.4;">Especialista en Auditor√≠a y Control Interno<br>M√°s de 15 a√±os de experiencia</p>
            </div>
            <div style="margin-top: auto; text-align: center;">
              <div style="background: rgba(255,255,255,0.1); padding: 3mm; border-radius: 4px; margin-bottom: 4mm;">
                <p style="font-size: 13px; font-weight: 600;">¬°Agenda una consulta gratuita!</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Separador entre lados -->
      <div style="text-align: center; margin: 30px 0; width: 100%;">
        <div style="border-top: 2px dashed #ccc; padding-top: 20px;">
          <h3 style="color: var(--primary-blue);">LADO B - Interior (Contenido detallado)</h3>
        </div>
      </div>
      
      <!-- LADO B - Interior (Contenido detallado) -->
      <div class="triptych side-b">
        <!-- Panel 4 (Interior izquierdo) CON IMAGEN -->
        <div class="panel panel-d">
          <div class="triptych-content">
            <h2 class="triptych-title" style="color: var(--primary-blue);">Nuestra Filosof√≠a</h2>
            <p class="triptych-text" style="color: var(--text-dark);">
              Creemos que la auditor√≠a no es un evento aislado, sino un proceso que se construye junto al cliente.
            </p>
            <img src="https://i.imgur.com/H9u54tb.png" class="content-image" alt="Filosof√≠a de trabajo">
            <div style="margin: 5mm 0;">
              <h3 style="color: var(--accent-blue); font-size: 14px; margin-bottom: 2mm;">Pilares Fundamentales</h3>
              <ul class="triptych-list">
                <li><strong>Control como crecimiento:</strong> Transformamos el control en palanca estrat√©gica</li>
                <li><strong>Confianza como resultado:</strong> Construimos relaciones basadas en transparencia</li>
                <li><strong>Acompa√±amiento como diferencial:</strong> Proximidad en cada etapa del proceso</li>
              </ul>
            </div>
            <div class="highlight-box">
              <p style="font-size: 11px; line-height: 1.5; color: var(--text-dark);">
                <strong>Nos involucramos</strong> de forma activa, ordenada, puntual y oportuna, acompa√±ando cada decisi√≥n con criterio profesional.
              </p>
            </div>
          </div>
        </div>
        
        <!-- Panel 5 (Interior central) CON IMAGEN -->
        <div class="panel panel-e">
          <div class="triptych-content">
            <h2 class="triptych-title" style="color: var(--primary-blue);">Servicios Especializados</h2>
            <div style="margin: 5mm 0;">
              <h3 style="color: var(--accent-blue); font-size: 14px; margin-bottom: 3mm;">Auditor√≠a</h3>
              <p style="font-size: 11px; line-height: 1.4; margin-bottom: 3mm; color: var(--text-dark);">
                Enfoque preventivo que brinda transparencia, confianza y solidez a la informaci√≥n financiera.
              </p>
              <ul class="triptych-list">
                <li>Auditor√≠a Fiscal</li>
                <li>Auditor√≠a de Estados Financieros</li>
                <li>Control Interno</li>
                <li>Servicios de Aseguramiento</li>
                <li>Dict√°menes e Informes Especiales</li>
              </ul>
            </div>
            <img src="https://i.imgur.com/XYIbALB.png" class="content-image" alt="Servicios BPS y BPO">
            <div style="margin: 6mm 0;">
              <h3 style="color: var(--accent-blue); font-size: 14px; margin-bottom: 3mm;">BPS & BPO</h3>
              <p style="font-size: 11px; line-height: 1.4; margin-bottom: 3mm; color: var(--text-dark);">
                Externalizaci√≥n de procesos con control y disciplina operativa.
              </p>
              <div class="column-container">
                <div class="column-section">
                  <strong>Contabilidad:</strong>
                  <ul style="list-style: none; margin-top: 1mm; padding-left: 0;">
                    <li style="font-size: 10px; padding: 1mm 0;">‚Ä¢ Gesti√≥n de procesos</li>
                    <li style="font-size: 10px; padding: 1mm 0;">‚Ä¢ Cumplimiento tributario</li>
                    <li style="font-size: 10px; padding: 1mm 0;">‚Ä¢ Reconciliaciones</li>
                  </ul>
                </div>
                <div class="column-section">
                  <strong>Administraci√≥n:</strong>
                  <ul style="list-style: none; margin-top: 1mm; padding-left: 0;">
                    <li style="font-size: 10px; padding: 1mm 0;">‚Ä¢ Cuentas por cobrar/pagar</li>
                    <li style="font-size: 10px; padding: 1mm 0;">‚Ä¢ N√≥mina</li>
                    <li style="font-size: 10px; padding: 1mm 0;">‚Ä¢ Control de activos</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Panel 6 (Interior derecho) CON IMAGEN -->
        <div class="panel panel-f">
          <div class="triptych-content">
            <div style="margin-bottom: 6mm;">
              <h2 class="triptych-title" style="color: var(--primary-blue);">Misi√≥n & Visi√≥n</h2>
              <div style="margin: 5mm 0;">
                <h3 style="color: var(--accent-blue); font-size: 14px; margin-bottom: 2mm;">Misi√≥n</h3>
                <p style="font-size: 11px; line-height: 1.4; color: var(--text-dark);">
                  Acompa√±ar a nuestros clientes en procesos de auditor√≠a y control con un enfoque integral.
                </p>
              </div>
              <div style="margin: 5mm 0;">
                <h3 style="color: var(--accent-blue); font-size: 14px; margin-bottom: 2mm;">Visi√≥n</h3>
                <p style="font-size: 11px; line-height: 1.4; color: var(--text-dark);">
                  Ser una firma referente a nivel nacional por nuestra manera de conducir los procesos de auditor√≠a.
                </p>
              </div>
            </div>
            <img src="https://i.imgur.com/N7bvlVG.png" class="content-image" alt="Control operativo" style="max-height: 30mm;">
            <img src="https://i.imgur.com/x5CPPGg.png" class="content-image" alt="Valores corporativos" style="max-height: 28mm; margin-top: 0;">
            <div class="contact-info" style="margin-top: auto;">
              <h3 style="color: var(--primary-blue); font-size: 13px; margin-bottom: 2mm;">Contacto</h3>
              <p style="font-size: 11px; line-height: 1.4; margin-bottom: 1mm;"><strong>CP Gilberto Pulido</strong><br>Especialista en Auditor√≠a y Control Interno</p>
              <p style="font-size: 10px; color: var(--text-light);">
                Tel: +52-56-6855-0117<br>
                Email: contacto@pulidoasesores.com<br>
                WhatsApp: +52-56-6855-0117
              </p>
              <div style="margin-top: 3mm; padding: 2mm; background: #f8f9fa; border-radius: 3px;">
                <p style="font-size: 10px; text-align: center; color: var(--accent-blue);">
                  <strong>¬°Solicita tu auditor√≠a de diagn√≥stico sin costo!</strong>
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Instrucciones de impresi√≥n -->
    <div class="print-instructions">
      <h3>‚úÖ Dise√±o ajustado para impresi√≥n perfecta</h3>
      <p>Se han realizado los siguientes ajustes para garantizar que todos los elementos quepan en la hoja A4:</p>
      <div class="print-steps">
        <div class="step">
          <span class="step-number">1</span>
          <strong>Reducci√≥n de tama√±os</strong>
          <p>Fuentes reducidas: t√≠tulos 22px, texto 12px, listas 11px. Im√°genes ajustadas a 35mm m√°ximo.</p>
        </div>
        <div class="step">
          <span class="step-number">2</span>
          <strong>Optimizaci√≥n de espacios</strong>
          <p>M√°rgenes y padding reducidos. Espaciado entre elementos optimizado para caber en 210mm.</p>
        </div>
        <div class="step">
          <span class="step-number">3</span>
          <strong>Control de desbordamiento</strong>
          <p>Se agreg√≥ <code>overflow: hidden</code> a contenedores principales para evitar elementos fuera de hoja.</p>
        </div>
        <div class="step">
          <span class="step-number">4</span>
          <strong>Mantenimiento de rebase</strong>
          <p>Se conserva el rebase de 1.2cm para impresi√≥n profesional con marcas de corte.</p>
        </div>
      </div>
      <div style="margin-top: 15px; padding: 10px; background: #e8f4fd; border-radius: 4px;">
        <p style="font-size: 14px; color: var(--primary-blue);">
          <strong>Problema solucionado:</strong> Los elementos que se sal√≠an de la hoja han sido corregidos mediante reducci√≥n proporcional de todos los componentes del dise√±o.
        </p>
      </div>
    </div>
  </div>
</div>

<!-- Modal de ayuda -->
<div id="helpModal" class="modal">
  <div class="modal-content">
    <button class="modal-close" onclick="closeHelpModal()">&times;</button>
    <h2>‚úÖ Dise√±o Corregido para Impresi√≥n</h2>
    <p>El problema de elementos desbordados ha sido solucionado mediante:</p>
    <ol style="margin-left: 20px; margin-bottom: 15px;">
      <li><strong>Reducci√≥n de fuentes:</strong> Todos los textos reducidos proporcionalmente</li>
      <li><strong>Ajuste de im√°genes:</strong> Altura m√°xima limitada a 35mm</li>
      <li><strong>Optimizaci√≥n de m√°rgenes:</strong> Espaciado interno reducido en todos los paneles</li>
      <li><strong>Control de overflow:</strong> Contenedores configurados para evitar desbordamiento</li>
    </ol>
    
    <h3>Para verificar la correcci√≥n:</h3>
    <p>1. Haga clic en "Vista previa de impresi√≥n" (Ctrl+P) en su navegador<br>
    2. Verifique que todos los elementos est√©n dentro de los m√°rgenes de la p√°gina<br>
    3. Descargue el PDF para confirmar que se genera correctamente</p>
    
    <div style="margin-top: 20px; padding: 10px; background: #f8f9fa; border-radius: 4px;">
      <p><strong>¬øA√∫n ve problemas de desbordamiento?</strong><br>
      Env√≠e una captura a: contacto@pulidoasesores.com para ajustes espec√≠ficos.</p>
    </div>
  </div>
</div>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script>
// Funcionalidad para modal
function openHelpModal() { document.getElementById('helpModal').style.display = 'flex'; }
function closeHelpModal() { document.getElementById('helpModal').style.display = 'none'; }
document.getElementById('helpModal').addEventListener('click', function(e) { if (e.target === this) closeHelpModal(); });
document.getElementById('openHelp').addEventListener('click', openHelpModal);

// Funci√≥n para descargar PDF del tr√≠ptico
document.getElementById('downloadTriptico').addEventListener('click', generateTripticoPDF);
function generateTripticoPDF() {
  const loadingOverlay = document.createElement('div');
  loadingOverlay.style.cssText = `position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; color: white; font-size: 18px;`;
  loadingOverlay.innerHTML = `<div style="width: 50px; height: 50px; border: 5px solid #f3f3f3; border-top: 5px solid var(--accent-blue); border-radius: 50%; animation: spin 1s linear infinite;"></div><div style="margin-top: 20px;">Generando PDF con dise√±o ajustado...</div><style>@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }</style>`;
  document.body.appendChild(loadingOverlay);

  // Clonar el contenido del tr√≠ptico para el PDF
  const triptychContent = document.querySelector('.triptych-preview').cloneNode(true);
  triptychContent.querySelector('.print-instructions').remove();
  const titleElements = triptychContent.querySelectorAll('h2, h3, p');
  titleElements.forEach(el => {
    if (el.textContent.includes('Vista Previa') || 
        el.textContent.includes('LADO') || 
        el.textContent.includes('Dise√±o ajustado') ||
        el.textContent.includes('‚úÖ')) {
      el.remove();
    }
  });

  // A√±adir estilos espec√≠ficos para el PDF
  const pdfStyles = document.createElement('style');
  pdfStyles.textContent = `
    @media print {
      @page { 
        size: A4 portrait; 
        margin: 12mm !important; 
        marks: crop cross; 
      }
      body { 
        margin: 0 !important; 
        padding: 0 !important; 
        background: white !important; 
        width: 100% !important;
        height: 100% !important;
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
      }
      .triptych { 
        box-shadow: none !important; 
        margin: 0 !important; 
        padding: 0 !important;
      }
      .panel { 
        width: 99mm !important; 
        height: 210mm !important; 
        padding: 18mm 10mm 12mm 10mm !important; 
        margin: 0 !important; 
        overflow: hidden !important;
      }
      .triptych-content {
        height: 186mm !important;
        overflow: hidden !important;
      }
      .side-a, .side-b { page-break-after: always !important; }
    }
    body { 
      font-family: 'Segoe UI', system-ui, sans-serif !important; 
      margin: 0 !important; 
      padding: 0 !important;
    }
    .triptych { 
      display: flex !important; 
      width: 297mm !important; 
    }
    .panel { 
      width: 99mm !important; 
      height: 210mm !important; 
      padding: 18mm 10mm 12mm 10mm !important; 
      page-break-inside: avoid !important; 
      overflow: hidden !important;
    }
    .side-a, .side-b { 
      page-break-after: always !important; 
    }
    .content-image {
      max-height: 35mm !important;
      page-break-inside: avoid !important;
    }
  `;
  triptychContent.appendChild(pdfStyles);

  // Configuraci√≥n de PDF con alta calidad para impresi√≥n
  const opt = {
    margin: [0, 0, 0, 0],
    filename: 'Pulido-Asesores-Triptico-Ajustado.pdf',
    image: { 
      type: 'jpeg', 
      quality: 0.98,
      scale: 2
    },
    html2canvas: { 
      scale: 2,
      useCORS: true,
      scrollY: 0,
      width: 900,
      height: 1275, // A4 proportion (900x1275)
      backgroundColor: '#ffffff',
      logging: false,
      letterRendering: true,
      allowTaint: true
    },
    jsPDF: { 
      unit: 'mm', 
      format: 'a4', 
      orientation: 'portrait',
      compress: true,
      hotfixes: ["px_scaling"]
    },
    pagebreak: { 
      mode: ['avoid-all', 'css', 'legacy'],
      before: '.side-b'
    }
  };

  // Generar y descargar el PDF
  setTimeout(() => {
    html2pdf()
      .set(opt)
      .from(triptychContent)
      .save()
      .then(() => {
        document.body.removeChild(loadingOverlay);
        const notification = document.createElement('div');
        notification.style.cssText = `position: fixed; top: 20px; right: 20px; background: #28a745; color: white; padding: 15px 25px; border-radius: 4px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); z-index: 9999;`;
        notification.innerHTML = `<i class="fas fa-check-circle"></i> PDF con dise√±o ajustado generado exitosamente`;
        document.body.appendChild(notification);
        setTimeout(() => { 
          notification.style.opacity = '0'; 
          notification.style.transform = 'translateX(100%)'; 
          notification.style.transition = 'all 0.3s ease'; 
          setTimeout(() => { document.body.removeChild(notification); }, 300); 
        }, 3000);
      })
      .catch(err => {
        console.error('Error generando PDF:', err);
        document.body.removeChild(loadingOverlay);
        const errorNotification = document.createElement('div');
        errorNotification.style.cssText = `position: fixed; top: 20px; right: 20px; background: #dc3545; color: white; padding: 15px 25px; border-radius: 4px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); z-index: 9999;`;
        errorNotification.textContent = 'Error al generar el PDF. Intente nuevamente.';
        document.body.appendChild(errorNotification);
        setTimeout(() => { errorNotification.remove(); }, 5000);
      });
  }, 1000);
}

// Verificaci√≥n de dimensiones
document.addEventListener('DOMContentLoaded', function() {
  console.log('‚úÖ Tr√≠ptico ajustado para impresi√≥n A4');
  console.log('üìê Dimensiones por panel: 99mm x 210mm');
  console.log('üéØ Rebase configurado: 1.2cm en todos los bordes');
  console.log('üñ®Ô∏è Use Ctrl+P para vista previa de impresi√≥n');
});
</script>
</body>
</html>
